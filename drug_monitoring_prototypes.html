<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>药品使用监测质量控制平台 - 界面原型</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft YaHei', Arial, sans-serif;
            background-color: #f5f7fa;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .page {
            display: none;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            padding: 30px;
            margin-bottom: 20px;
        }

        .page.active {
            display: block;
        }

        .page-header {
            border-bottom: 2px solid #e8f4fd;
            padding-bottom: 15px;
            margin-bottom: 25px;
        }

        .page-title {
            color: #1890ff;
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .page-description {
            color: #666;
            font-size: 14px;
            line-height: 1.6;
        }

        .nav-bar {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 15px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }

        .nav-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 20px;
        }

        .logo {
            color: white;
            font-size: 20px;
            font-weight: 600;
        }

        .nav-menu {
            display: flex;
            gap: 30px;
        }

        .nav-item {
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 6px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .nav-item:hover, .nav-item.active {
            background: rgba(255,255,255,0.2);
            transform: translateY(-1px);
        }

        .user-info {
            color: white;
            font-size: 14px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #d9d9d9;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-input:focus {
            outline: none;
            border-color: #1890ff;
            box-shadow: 0 0 0 2px rgba(24,144,255,0.2);
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-primary {
            background: #1890ff;
            color: white;
        }

        .btn-primary:hover {
            background: #40a9ff;
            transform: translateY(-1px);
        }

        .btn-success {
            background: #52c41a;
            color: white;
        }

        .btn-warning {
            background: #faad14;
            color: white;
        }

        .btn-danger {
            background: #ff4d4f;
            color: white;
        }

        .upload-area {
            border: 2px dashed #d9d9d9;
            border-radius: 8px;
            padding: 40px 20px;
            text-align: center;
            transition: all 0.3s;
            cursor: pointer;
        }

        .upload-area:hover {
            border-color: #1890ff;
            background: #f0f8ff;
        }

        .upload-icon {
            font-size: 48px;
            color: #1890ff;
            margin-bottom: 15px;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .table th, .table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #f0f0f0;
        }

        .table th {
            background: #fafafa;
            font-weight: 600;
            color: #333;
        }

        .table tr:hover {
            background: #f5f5f5;
        }

        .status-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-success {
            background: #f6ffed;
            color: #52c41a;
            border: 1px solid #b7eb8f;
        }

        .status-warning {
            background: #fffbe6;
            color: #faad14;
            border: 1px solid #ffe58f;
        }

        .status-error {
            background: #fff2f0;
            color: #ff4d4f;
            border: 1px solid #ffccc7;
        }

        .status-processing {
            background: #e6f7ff;
            color: #1890ff;
            border: 1px solid #91d5ff;
        }

        .card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #f0f0f0;
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #1890ff, #40a9ff);
            transition: width 0.3s;
        }

        .alert {
            padding: 12px 16px;
            border-radius: 6px;
            margin-bottom: 20px;
        }

        .alert-info {
            background: #e6f7ff;
            border: 1px solid #91d5ff;
            color: #1890ff;
        }

        .alert-warning {
            background: #fffbe6;
            border: 1px solid #ffe58f;
            color: #faad14;
        }

        .alert-error {
            background: #fff2f0;
            border: 1px solid #ffccc7;
            color: #ff4d4f;
        }

        .tabs {
            border-bottom: 1px solid #f0f0f0;
            margin-bottom: 20px;
        }

        .tab-item {
            display: inline-block;
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }

        .tab-item.active {
            color: #1890ff;
            border-bottom-color: #1890ff;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 24px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
        }

        .stat-number {
            font-size: 32px;
            font-weight: 600;
            color: #1890ff;
            margin-bottom: 8px;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
        }

        .filter-bar {
            background: #fafafa;
            padding: 16px;
            border-radius: 6px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }

        .filter-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-item label {
            font-size: 14px;
            color: #666;
            white-space: nowrap;
        }

        .filter-item select, .filter-item input {
            padding: 6px 10px;
            border: 1px solid #d9d9d9;
            border-radius: 4px;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <!-- 导航栏 -->
    <nav class="nav-bar">
        <div class="nav-container">
            <div class="logo">药品使用监测质量控制平台</div>
            <div class="nav-menu">
                <a href="#" class="nav-item active" onclick="showPage('dashboard')">工作台</a>
                <a href="#" class="nav-item" onclick="showPage('upload')">数据导入</a>
                <a href="#" class="nav-item" onclick="showPage('qc-rules')">质控管理</a>
                <a href="#" class="nav-item" onclick="showPage('data-governance')">数据治理</a>
                <a href="#" class="nav-item" onclick="showPage('ypid-management')">YPID管理</a>
                <a href="#" class="nav-item" onclick="showPage('reports')">报告中心</a>
            </div>
            <div class="user-info">数据管理员 | 张医生</div>
        </div>
    </nav>

    <div class="container">
        <!-- 1. 工作台首页 -->
        <div id="dashboard" class="page active">
            <div class="page-header">
                <h1 class="page-title">工作台</h1>
                <p class="page-description">
                    <strong>界面目的：</strong> 为用户提供系统整体运行状况的概览视图，快速了解数据处理进度、质控状态和关键指标。<br>
                    <strong>主要功能：</strong> 展示任务统计、质控概况、待处理事项、系统状态监控等关键信息，支持快速导航到具体功能模块。
                </p>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-number">156</div>
                    <div class="stat-label">本月导入任务</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">94.5%</div>
                    <div class="stat-label">数据质控通过率</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">23</div>
                    <div class="stat-label">待处理异常</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">87.2%</div>
                    <div class="stat-label">YPID匹配率</div>
                </div>
            </div>

            <div class="grid">
                <div class="card">
                    <h3 class="card-title">最近导入任务</h3>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>任务名称</th>
                                <th>状态</th>
                                <th>完成时间</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>北京协和医院_2024年度数据</td>
                                <td><span class="status-badge status-success">已完成</span></td>
                                <td>2024-05-28 14:30</td>
                            </tr>
                            <tr>
                                <td>上海瑞金医院_2024年度数据</td>
                                <td><span class="status-badge status-processing">处理中</span></td>
                                <td>进行中</td>
                            </tr>
                            <tr>
                                <td>广州中山医院_2024年度数据</td>
                                <td><span class="status-badge status-warning">质控异常</span></td>
                                <td>2024-05-27 16:45</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="card">
                    <h3 class="card-title">质控规则执行情况</h3>
                    <div style="margin: 15px 0;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span>前置质控规则</span>
                            <span>22/22 执行正常</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 100%;"></div>
                        </div>
                    </div>
                    <div style="margin: 15px 0;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span>后置质控规则</span>
                            <span>6/7 执行正常</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 85.7%;"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="alert alert-info">
                <strong>系统提醒：</strong> 发现3个医疗机构的数据存在YPID匹配异常，建议优先处理。
                <a href="#" onclick="showPage('ypid-management')" style="margin-left: 10px;">立即处理 →</a>
            </div>
        </div>

        <!-- 2. 数据导入界面 -->
        <div id="upload" class="page">
            <div class="page-header">
                <h1 class="page-title">数据导入</h1>
                <p class="page-description">
                    <strong>界面目的：</strong> 提供Excel文件上传和解析功能，支持五张药品相关表的批量导入，实现前置质控验证。<br>
                    <strong>主要功能：</strong> 文件上传、数据解析、前置质控、导入进度监控、错误信息反馈、数据预览和确认导入。
                </p>
            </div>

            <div class="tabs">
                <div class="tab-item active" onclick="switchTab('upload-tab', this)">文件上传</div>
                <div class="tab-item" onclick="switchTab('progress-tab', this)">导入进度</div>
                <div class="tab-item" onclick="switchTab('history-tab', this)">导入历史</div>
            </div>

            <div id="upload-tab" class="tab-content active">
                <div class="form-group">
                    <label class="form-label">选择导入文件</label>
                    <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                        <div class="upload-icon">📁</div>
                        <h3>点击或拖拽Excel文件到此处</h3>
                        <p>支持.xlsx、.xls格式，文件大小不超过100MB</p>
                        <input type="file" id="fileInput" style="display: none;" accept=".xlsx,.xls">
                    </div>
                </div>

                <div class="alert alert-info">
                    <strong>文件要求：</strong> Excel文件需包含以下五张工作表：
                    1. 公立医疗机构基本情况_2024
                    2. 公立医疗机构药品目录_2024
                    3. 公立医疗机构药品入库情况_2024
                    4. 公立医疗机构药品出库情况_2024
                    5. 公立医疗机构药品使用情况_2024
                </div>

                <div class="form-group">
                    <label class="form-label">导入配置</label>
                    <div style="display: flex; gap: 20px; align-items: center;">
                        <label><input type="checkbox" checked> 启用前置质控</label>
                        <label><input type="checkbox" checked> 自动YPID匹配</label>
                        <label><input type="checkbox"> 跳过重复数据</label>
                    </div>
                </div>

                <div style="text-align: center; margin-top: 30px;">
                    <button class="btn btn-primary" style="padding: 12px 40px;">开始解析并导入</button>
                </div>
            </div>

            <div id="progress-tab" class="tab-content">
                <div class="card">
                    <h3 class="card-title">当前任务进度</h3>
                    <div style="margin: 20px 0;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span>文件解析进度</span>
                            <span>75%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 75%;"></div>
                        </div>
                    </div>
                    <div style="margin: 20px 0;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span>前置质控进度</span>
                            <span>45%</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 45%;"></div>
                        </div>
                    </div>
                    <p style="color: #666; margin-top: 15px;">
                        正在处理：公立医疗机构药品目录_2024 (第3张表/共5张表)
                    </p>
                </div>
            </div>

            <div id="history-tab" class="tab-content">
                <div class="filter-bar">
                    <div class="filter-item">
                        <label>时间范围：</label>
                        <input type="date" value="2024-05-01">
                        <span>至</span>
                        <input type="date" value="2024-05-29">
                    </div>
                    <div class="filter-item">
                        <label>状态：</label>
                        <select>
                            <option>全部状态</option>
                            <option>导入成功</option>
                            <option>导入失败</option>
                            <option>质控异常</option>
                        </select>
                    </div>
                    <button class="btn btn-primary">查询</button>
                </div>

                <table class="table">
                    <thead>
                        <tr>
                            <th>任务ID</th>
                            <th>文件名</th>
                            <th>总记录数</th>
                            <th>成功记录</th>
                            <th>错误记录</th>
                            <th>状态</th>
                            <th>导入时间</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>TASK_20240528_001</td>
                            <td>北京协和医院_2024年度数据.xlsx</td>
                            <td>12,350</td>
                            <td>12,180</td>
                            <td>170</td>
                            <td><span class="status-badge status-success">已完成</span></td>
                            <td>2024-05-28 14:30</td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">查看详情</button>
                                <button class="btn btn-warning" style="padding: 4px 8px; font-size: 12px;">下载报告</button>
                            </td>
                        </tr>
                        <tr>
                            <td>TASK_20240527_003</td>
                            <td>广州中山医院_2024年度数据.xlsx</td>
                            <td>8,920</td>
                            <td>8,450</td>
                            <td>470</td>
                            <td><span class="status-badge status-warning">质控异常</span></td>
                            <td>2024-05-27 16:45</td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">查看详情</button>
                                <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;">重新处理</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 3. 质控管理界面 -->
        <div id="qc-rules" class="page">
            <div class="page-header">
                <h1 class="page-title">质控管理</h1>
                <p class="page-description">
                    <strong>界面目的：</strong> 管理和配置前置、后置质控规则，监控质控执行结果，处理质控异常数据。<br>
                    <strong>主要功能：</strong> 质控规则配置、规则执行监控、异常数据查看、质控报告生成、规则优先级设置和批量操作。
                </p>
            </div>

            <div class="tabs">
                <div class="tab-item active" onclick="switchTab('pre-qc-tab', this)">前置质控</div>
                <div class="tab-item" onclick="switchTab('post-qc-tab', this)">后置质控</div>
                <div class="tab-item" onclick="switchTab('qc-results-tab', this)">质控结果</div>
                <div class="tab-item" onclick="switchTab('rule-config-tab', this)">规则配置</div>
            </div>

            <div id="pre-qc-tab" class="tab-content active">
                <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 20px;">
                    <h3>前置质控规则 (22项)</h3>
                    <button class="btn btn-primary">新增规则</button>
                </div>

                <table class="table">
                    <thead>
                        <tr>
                            <th>规则编码</th>
                            <th>规则名称</th>
                            <th>规则类别</th>
                            <th>优先级</th>
                            <th>状态</th>
                            <th>最后执行</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>PRE_001</td>
                            <td>联合主键字段不唯一</td>
                            <td>全局控制</td>
                            <td>高</td>
                            <td><span class="status-badge status-success">已启用</span></td>
                            <td>2024-05-29 09:15</td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">编辑</button>
                                <button class="btn btn-warning" style="padding: 4px 8px; font-size: 12px;">停用</button>
                            </td>
                        </tr>
                        <tr>
                            <td>PRE_002</td>
                            <td>必填项未按要求填报</td>
                            <td>全局控制</td>
                            <td>高</td>
                            <td><span class="status-badge status-success">已启用</span></td>
                            <td>2024-05-29 09:15</td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">编辑</button>
                                <button class="btn btn-warning" style="padding: 4px 8px; font-size: 12px;">停用</button>
                            </td>
                        </tr>
                        <tr>
                            <td>PRE_003</td>
                            <td>YPID编码空值检查</td>
                            <td>单个字段控制</td>
                            <td>中</td>
                            <td><span class="status-badge status-success">已启用</span></td>
                            <td>2024-05-29 09:15</td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">编辑</button>
                                <button class="btn btn-warning" style="padding: 4px 8px; font-size: 12px;">停用</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="post-qc-tab" class="tab-content">
                <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 20px;">
                    <h3>后置质控规则 (7项)</h3>
                    <button class="btn btn-primary">新增规则</button>
                </div>

                <table class="table">
                    <thead>
                        <tr>
                            <th>规则编码</th>
                            <th>规则名称</th>
                            <th>规则类别</th>
                            <th>阈值设置</th>
                            <th>状态</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>POST_001</td>
                            <td>金额或数量填写错误</td>
                            <td>数据逻辑错误</td>
                            <td>±100倍参考价格</td>
                            <td><span class="status-badge status-success">已启用</span></td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">编辑</button>
                            </td>
                        </tr>
                        <tr>
                            <td>POST_002</td>
                            <td>销售金额为0</td>
                            <td>单个字段控制</td>
                            <td>严格检查</td>
                            <td><span class="status-badge status-success">已启用</span></td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">编辑</button>
                            </td>
                        </tr>
                        <tr>
                            <td>POST_007</td>
                            <td>价格统计异常</td>
                            <td>数据逻辑错误</td>
                            <td>±3倍标准差</td>
                            <td><span class="status-badge status-warning">调试中</span></td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">编辑</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="qc-results-tab" class="tab-content">
                <div class="filter-bar">
                    <div class="filter-item">
                        <label>质控类型：</label>
                        <select>
                            <option>全部类型</option>
                            <option>前置质控</option>
                            <option>后置质控</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label>结果状态：</label>
                        <select>
                            <option>全部状态</option>
                            <option>质控通过</option>
                            <option>质控失败</option>
                            <option>待修复</option>
                        </select>
                    </div>
                    <button class="btn btn-primary">查询</button>
                    <button class="btn btn-success">批量修复</button>
                </div>

                <table class="table">
                    <thead>
                        <tr>
                            <th>任务ID</th>
                            <th>机构名称</th>
                            <th>质控类型</th>
                            <th>触发规则</th>
                            <th>错误数量</th>
                            <th>状态</th>
                            <th>检测时间</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>TASK_20240528_001</td>
                            <td>北京协和医院</td>
                            <td>前置质控</td>
                            <td>YPID编码空值</td>
                            <td>23</td>
                            <td><span class="status-badge status-warning">待修复</span></td>
                            <td>2024-05-28 14:32</td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">查看详情</button>
                                <button class="btn btn-success" style="padding: 4px 8px; font-size: 12px;">修复</button>
                            </td>
                        </tr>
                        <tr>
                            <td>TASK_20240527_003</td>
                            <td>广州中山医院</td>
                            <td>后置质控</td>
                            <td>价格统计异常</td>
                            <td>47</td>
                            <td><span class="status-badge status-error">质控失败</span></td>
                            <td>2024-05-27 16:48</td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">查看详情</button>
                                <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;">重新检测</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="rule-config-tab" class="tab-content">
                <div class="card">
                    <h3 class="card-title">质控规则配置</h3>
                    <form>
                        <div class="form-group">
                            <label class="form-label">规则名称</label>
                            <input type="text" class="form-input" placeholder="请输入规则名称">
                        </div>
                        <div class="form-group">
                            <label class="form-label">规则类型</label>
                            <select class="form-input">
                                <option>前置质控</option>
                                <option>后置质控</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">规则表达式</label>
                            <textarea class="form-input" rows="4" placeholder="请输入规则表达式，如：YPID IS NOT NULL AND LENGTH(YPID) = 12"></textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">错误提示信息</label>
                            <input type="text" class="form-input" placeholder="请输入错误提示信息">
                        </div>
                        <div style="text-align: center; margin-top: 20px;">
                            <button type="button" class="btn btn-primary">保存规则</button>
                            <button type="button" class="btn btn-warning" style="margin-left: 10px;">测试规则</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <!-- 4. 数据治理界面 -->
        <div id="data-governance" class="page">
            <div class="page-header">
                <h1 class="page-title">数据治理</h1>
                <p class="page-description">
                    <strong>界面目的：</strong> 提供异常数据的智能识别、修复和管理功能，提升数据质量和完整性。<br>
                    <strong>主要功能：</strong> 异常数据分析、自动修复策略执行、手动数据修复、修复结果验证、数据清洗规则管理和修复历史追踪。
                </p>
            </div>

            <div class="tabs">
                <div class="tab-item active" onclick="switchTab('anomaly-detection-tab', this)">异常检测</div>
                <div class="tab-item" onclick="switchTab('auto-repair-tab', this)">自动修复</div>
                <div class="tab-item" onclick="switchTab('manual-repair-tab', this)">手动修复</div>
                <div class="tab-item" onclick="switchTab('repair-history-tab', this)">修复历史</div>
            </div>

            <div id="anomaly-detection-tab" class="tab-content active">
                <div class="grid">
                    <div class="card">
                        <h3 class="card-title">异常数据统计</h3>
                        <div class="stats-grid" style="grid-template-columns: repeat(2, 1fr);">
                            <div style="text-align: center;">
                                <div style="font-size: 24px; color: #ff4d4f; font-weight: 600;">234</div>
                                <div style="color: #666; font-size: 14px;">价格异常</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-size: 24px; color: #faad14; font-weight: 600;">89</div>
                                <div style="color: #666; font-size: 14px;">数量异常</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-size: 24px; color: #1890ff; font-weight: 600;">156</div>
                                <div style="color: #666; font-size: 14px;">编码异常</div>
                            </div>
                            <div style="text-align: center;">
                                <div style="font-size: 24px; color: #52c41a; font-weight: 600;">45</div>
                                <div style="color: #666; font-size: 14px;">逻辑异常</div>
                            </div>
                        </div>
                        <button class="btn btn-primary" style="width: 100%; margin-top: 15px;">执行全面检测</button>
                    </div>

                    <div class="card">
                        <h3 class="card-title">修复策略配置</h3>
                        <div style="margin: 15px 0;">
                            <label style="display: flex; align-items: center; margin-bottom: 10px;">
                                <input type="checkbox" checked style="margin-right: 8px;">
                                价格异常自动修复 (基于众数±3σ)
                            </label>
                            <label style="display: flex; align-items: center; margin-bottom: 10px;">
                                <input type="checkbox" checked style="margin-right: 8px;">
                                数量逻辑修复 (包装量×转换系数)
                            </label>
                            <label style="display: flex; align-items: center; margin-bottom: 10px;">
                                <input type="checkbox" style="margin-right: 8px;">
                                YPID智能匹配 (基于药品名称)
                            </label>
                            <label style="display: flex; align-items: center; margin-bottom: 10px;">
                                <input type="checkbox" style="margin-right: 8px;">
                                删除无法修复的数据
                            </label>
                        </div>
                        <button class="btn btn-success" style="width: 100%;">启动自动修复</button>
                    </div>
                </div>

                <div class="filter-bar">
                    <div class="filter-item">
                        <label>异常类型：</label>
                        <select>
                            <option>全部异常</option>
                            <option>价格异常</option>
                            <option>数量异常</option>
                            <option>编码异常</option>
                            <option>逻辑异常</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label>严重程度：</label>
                        <select>
                            <option>全部</option>
                            <option>严重</option>
                            <option>中等</option>
                            <option>轻微</option>
                        </select>
                    </div>
                    <button class="btn btn-primary">筛选</button>
                </div>

                <table class="table">
                    <thead>
                        <tr>
                            <th>记录ID</th>
                            <th>机构名称</th>
                            <th>药品名称</th>
                            <th>异常类型</th>
                            <th>异常描述</th>
                            <th>严重程度</th>
                            <th>检测时间</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>REC_001234</td>
                            <td>北京协和医院</td>
                            <td>阿莫西林胶囊</td>
                            <td>价格异常</td>
                            <td>单价超出正常范围10倍</td>
                            <td><span class="status-badge status-error">严重</span></td>
                            <td>2024-05-29 09:15</td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">查看</button>
                                <button class="btn btn-success" style="padding: 4px 8px; font-size: 12px;">修复</button>
                            </td>
                        </tr>
                        <tr>
                            <td>REC_001235</td>
                            <td>上海瑞金医院</td>
                            <td>头孢氨苄片</td>
                            <td>数量异常</td>
                            <td>包装量与制剂量不匹配</td>
                            <td><span class="status-badge status-warning">中等</span></td>
                            <td>2024-05-29 09:18</td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">查看</button>
                                <button class="btn btn-success" style="padding: 4px 8px; font-size: 12px;">修复</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="auto-repair-tab" class="tab-content">
                <div class="alert alert-info">
                    <strong>自动修复规则说明：</strong> 系统将根据13种预设修复策略对异常数据进行自动修复，修复成功率约为80%。
                </div>

                <div class="card">
                    <h3 class="card-title">修复规则优先级</h3>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>优先级</th>
                                <th>修复规则</th>
                                <th>适用条件</th>
                                <th>修复逻辑</th>
                                <th>状态</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>不修复</td>
                                <td>0.5≤金额/制剂量/众数≤2</td>
                                <td>保持原值</td>
                                <td><span class="status-badge status-success">启用</span></td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>修制剂量，包装量</td>
                                <td>0.5≤金额/包装量/众数≤2</td>
                                <td>制剂量_fix = 包装量</td>
                                <td><span class="status-badge status-success">启用</span></td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>修金额，金额/10</td>
                                <td>注射剂 AND 价格条件满足</td>
                                <td>金额_fix = 金额/10</td>
                                <td><span class="status-badge status-success">启用</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div style="text-align: center; margin: 30px 0;">
                    <button class="btn btn-success" style="padding: 15px 40px; font-size: 16px;">执行批量自动修复</button>
                </div>
            </div>

            <div id="manual-repair-tab" class="tab-content">
                <div class="alert alert-warning">
                    <strong>手动修复说明：</strong> 对于自动修复无法处理的复杂异常数据，需要人工进行判断和修复。
                </div>

                <div class="card">
                    <h3 class="card-title">数据修复</h3>
                    <form>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                            <div>
                                <h4 style="margin-bottom: 15px; color: #333;">原始数据</h4>
                                <div class="form-group">
                                    <label class="form-label">药品名称</label>
                                    <input type="text" class="form-input" value="阿莫西林胶囊" readonly>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">销售金额</label>
                                    <input type="text" class="form-input" value="158,000.00" readonly style="color: #ff4d4f;">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">销售数量（制剂单位）</label>
                                    <input type="text" class="form-input" value="1,200" readonly>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">计算单价</label>
                                    <input type="text" class="form-input" value="131.67元/粒" readonly style="color: #ff4d4f;">
                                </div>
                            </div>
                            <div>
                                <h4 style="margin-bottom: 15px; color: #333;">修复数据</h4>
                                <div class="form-group">
                                    <label class="form-label">修复后销售金额</label>
                                    <input type="text" class="form-input" value="1,580.00" style="color: #52c41a;">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">修复后数量</label>
                                    <input type="text" class="form-input" value="1,200">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">修复后单价</label>
                                    <input type="text" class="form-input" value="1.32元/粒" readonly style="color: #52c41a;">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">修复说明</label>
                                    <textarea class="form-input" rows="3" placeholder="请输入修复原因和依据">销售金额疑似多输入两位0，根据同类药品价格范围，修正为1,580.00元</textarea>
                                </div>
                            </div>
                        </div>
                        <div style="text-align: center; margin-top: 20px;">
                            <button type="button" class="btn btn-success">确认修复</button>
                            <button type="button" class="btn btn-warning" style="margin-left: 10px;">忽略异常</button>
                            <button type="button" class="btn btn-danger" style="margin-left: 10px;">标记删除</button>
                        </div>
                    </form>
                </div>
            </div>

            <div id="repair-history-tab" class="tab-content">
                <div class="filter-bar">
                    <div class="filter-item">
                        <label>修复类型：</label>
                        <select>
                            <option>全部类型</option>
                            <option>自动修复</option>
                            <option>手动修复</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label>修复状态：</label>
                        <select>
                            <option>全部状态</option>
                            <option>修复成功</option>
                            <option>修复失败</option>
                            <option>待审核</option>
                        </select>
                    </div>
                    <button class="btn btn-primary">查询</button>
                </div>

                <table class="table">
                    <thead>
                        <tr>
                            <th>修复ID</th>
                            <th>记录ID</th>
                            <th>修复类型</th>
                            <th>修复策略</th>
                            <th>修复前值</th>
                            <th>修复后值</th>
                            <th>修复状态</th>
                            <th>操作人</th>
                            <th>修复时间</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>FIX_001</td>
                            <td>REC_001234</td>
                            <td>手动修复</td>
                            <td>价格修正</td>
                            <td>158,000.00</td>
                            <td>1,580.00</td>
                            <td><span class="status-badge status-success">修复成功</span></td>
                            <td>张医生</td>
                            <td>2024-05-29 10:30</td>
                        </tr>
                        <tr>
                            <td>FIX_002</td>
                            <td>REC_001235</td>
                            <td>自动修复</td>
                            <td>FIX0043</td>
                            <td>制剂量:800</td>
                            <td>制剂量:500</td>
                            <td><span class="status-badge status-success">修复成功</span></td>
                            <td>系统</td>
                            <td>2024-05-29 10:25</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 5. YPID管理界面 -->
        <div id="ypid-management" class="page">
            <div class="page-header">
                <h1 class="page-title">YPID管理</h1>
                <p class="page-description">
                    <strong>界面目的：</strong> 管理国家药管平台药品编码(YPID)的比对、匹配和维护工作，确保药品编码标准化。<br>
                    <strong>主要功能：</strong> YPID搜索查询、批量比对匹配、手动编码纠正、无法匹配数据处理、编码标准库管理和匹配历史追踪。
                </p>
            </div>

            <div class="tabs">
                <div class="tab-item active" onclick="switchTab('ypid-search-tab', this)">编码搜索</div>
                <div class="tab-item" onclick="switchTab('batch-match-tab', this)">批量匹配</div>
                <div class="tab-item" onclick="switchTab('unmatch-data-tab', this)">无法匹配</div>
                <div class="tab-item" onclick="switchTab('manual-match-tab', this)">手动匹配</div>
                <div class="tab-item" onclick="switchTab('ypid-library-tab', this)">标准库</div>
            </div>

            <div id="ypid-search-tab" class="tab-content active">
                <div class="card">
                    <h3 class="card-title">YPID编码搜索</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                        <div class="form-group">
                            <label class="form-label">药品通用名</label>
                            <input type="text" class="form-input" placeholder="请输入药品通用名，如：阿莫西林">
                        </div>
                        <div class="form-group">
                            <label class="form-label">产品名称</label>
                            <input type="text" class="form-input" placeholder="请输入产品名称">
                        </div>
                        <div class="form-group">
                            <label class="form-label">剂型</label>
                            <select class="form-input">
                                <option>全部剂型</option>
                                <option>片剂</option>
                                <option>胶囊剂</option>
                                <option>注射剂</option>
                                <option>颗粒剂</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">生产企业</label>
                            <input type="text" class="form-input" placeholder="请输入生产企业名称">
                        </div>
                    </div>
                    <div style="text-align: center;">
                        <button class="btn btn-primary">搜索YPID</button>
                        <button class="btn btn-warning" style="margin-left: 10px;">高级搜索</button>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">搜索结果</h3>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>YPID编码</th>
                                <th>药品通用名</th>
                                <th>产品名称</th>
                                <th>剂型</th>
                                <th>规格</th>
                                <th>生产企业</th>
                                <th>匹配度</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>YP0123456789</td>
                                <td>阿莫西林</td>
                                <td>阿莫西林胶囊</td>
                                <td>胶囊剂</td>
                                <td>0.25g</td>
                                <td>华北制药股份有限公司</td>
                                <td><span style="color: #52c41a;">95%</span></td>
                                <td>
                                    <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">选择</button>
                                    <button class="btn btn-warning" style="padding: 4px 8px; font-size: 12px;">查看详情</button>
                                </td>
                            </tr>
                            <tr>
                                <td>YP0123456790</td>
                                <td>阿莫西林</td>
                                <td>阿莫西林胶囊</td>
                                <td>胶囊剂</td>
                                <td>0.5g</td>
                                <td>华北制药股份有限公司</td>
                                <td><span style="color: #faad14;">87%</span></td>
                                <td>
                                    <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">选择</button>
                                    <button class="btn btn-warning" style="padding: 4px 8px; font-size: 12px;">查看详情</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="batch-match-tab" class="tab-content">
                <div class="alert alert-info">
                    <strong>批量匹配说明：</strong> 系统将使用自然语言处理技术，对未匹配的药品数据进行智能YPID匹配，匹配成功率约为85%。
                </div>

                <div class="grid">
                    <div class="card">
                        <h3 class="card-title">匹配任务配置</h3>
                        <div class="form-group">
                            <label class="form-label">匹配数据范围</label>
                            <select class="form-input">
                                <option>全部待匹配数据</option>
                                <option>指定医疗机构</option>
                                <option>指定导入任务</option>
                                <option>指定时间范围</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">匹配策略</label>
                            <div style="margin-top: 10px;">
                                <label style="display: block; margin-bottom: 8px;">
                                    <input type="checkbox" checked style="margin-right: 8px;">
                                    精确匹配 (通用名+剂型+规格+企业)
                                </label>
                                <label style="display: block; margin-bottom: 8px;">
                                    <input type="checkbox" checked style="margin-right: 8px;">
                                    模糊匹配 (基于语义相似度)
                                </label>
                                <label style="display: block; margin-bottom: 8px;">
                                    <input type="checkbox" style="margin-right: 8px;">
                                    智能纠错 (处理错别字和同音字)
                                </label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">匹配阈值</label>
                            <input type="range" min="60" max="100" value="85" style="width: 100%;">
                            <div style="text-align: center; margin-top: 5px; color: #666;">85%</div>
                        </div>
                        <button class="btn btn-primary" style="width: 100%;">开始批量匹配</button>
                    </div>

                    <div class="card">
                        <h3 class="card-title">匹配进度</h3>
                        <div style="margin: 20px 0;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>总体进度</span>
                                <span>1,234 / 2,000</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 61.7%;"></div>
                            </div>
                        </div>
                        <div style="margin: 15px 0; font-size: 14px; color: #666;">
                            <div>已匹配：1,048 条</div>
                            <div>部分匹配：186 条</div>
                            <div>无法匹配：766 条</div>
                        </div>
                        <div style="margin-top: 20px;">
                            <button class="btn btn-warning" style="margin-right: 10px;">暂停任务</button>
                            <button class="btn btn-danger">停止任务</button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">匹配结果预览</h3>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>院内药品名称</th>
                                <th>匹配的YPID</th>
                                <th>标准药品名称</th>
                                <th>匹配度</th>
                                <th>匹配类型</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>阿莫西林胶囊(0.25g*12粒)</td>
                                <td>YP0123456789</td>
                                <td>阿莫西林胶囊</td>
                                <td><span style="color: #52c41a;">95%</span></td>
                                <td>精确匹配</td>
                                <td>
                                    <button class="btn btn-success" style="padding: 4px 8px; font-size: 12px;">确认</button>
                                    <button class="btn btn-warning" style="padding: 4px 8px; font-size: 12px;">修改</button>
                                </td>
                            </tr>
                            <tr>
                                <td>头孢氨苄片(0.25g)</td>
                                <td>YP0234567890</td>
                                <td>头孢氨苄片</td>
                                <td><span style="color: #faad14;">78%</span></td>
                                <td>模糊匹配</td>
                                <td>
                                    <button class="btn btn-success" style="padding: 4px 8px; font-size: 12px;">确认</button>
                                    <button class="btn btn-warning" style="padding: 4px 8px; font-size: 12px;">修改</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="unmatch-data-tab" class="tab-content">
                <div class="filter-bar">
                    <div class="filter-item">
                        <label>医疗机构：</label>
                        <select>
                            <option>全部机构</option>
                            <option>北京协和医院</option>
                            <option>上海瑞金医院</option>
                            <option>广州中山医院</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label>剂型：</label>
                        <select>
                            <option>全部剂型</option>
                            <option>片剂</option>
                            <option>胶囊剂</option>
                            <option>注射剂</option>
                        </select>
                    </div>
                    <button class="btn btn-primary">筛选</button>
                    <button class="btn btn-success">批量手动匹配</button>
                </div>

                <table class="table">
                    <thead>
                        <tr>
                            <th>
                                <input type="checkbox" onchange="toggleAll(this)">
                            </th>
                            <th>院内药品编码</th>
                            <th>院内药品名称</th>
                            <th>剂型</th>
                            <th>规格</th>
                            <th>生产企业</th>
                            <th>数据来源</th>
                            <th>无法匹配原因</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><input type="checkbox"></td>
                            <td>DRUG_001</td>
                            <td>阿斯匹林肠溶片(拜阿司匹林)</td>
                            <td>片剂</td>
                            <td>100mg</td>
                            <td>拜耳医药保健有限公司</td>
                            <td>北京协和医院</td>
                            <td>商品名不在标准库</td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">手动匹配</button>
                                <button class="btn btn-warning" style="padding: 4px 8px; font-size: 12px;">申请新增</button>
                            </td>
                        </tr>
                        <tr>
                            <td><input type="checkbox"></td>
                            <td>DRUG_002</td>
                            <td>自制制剂A</td>
                            <td>溶液剂</td>
                            <td>100ml</td>
                            <td>医院自制</td>
                            <td>上海瑞金医院</td>
                            <td>自制制剂无标准编码</td>
                            <td>
                                <button class="btn btn-warning" style="padding: 4px 8px; font-size: 12px;">标记忽略</button>
                                <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;">删除记录</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="manual-match-tab" class="tab-content">
                <div class="card">
                    <h3 class="card-title">手动YPID匹配</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                        <div>
                            <h4 style="margin-bottom: 15px; color: #333;">待匹配药品信息</h4>
                            <div class="form-group">
                                <label class="form-label">院内药品名称</label>
                                <input type="text" class="form-input" value="阿斯匹林肠溶片(拜阿司匹林)" readonly>
                            </div>
                            <div class="form-group">
                                <label class="form-label">剂型</label>
                                <input type="text" class="form-input" value="片剂" readonly>
                            </div>
                            <div class="form-group">
                                <label class="form-label">规格</label>
                                <input type="text" class="form-input" value="100mg" readonly>
                            </div>
                            <div class="form-group">
                                <label class="form-label">生产企业</label>
                                <input type="text" class="form-input" value="拜耳医药保健有限公司" readonly>
                            </div>
                        </div>
                        <div>
                            <h4 style="margin-bottom: 15px; color: #333;">选择匹配的YPID</h4>
                            <div class="form-group">
                                <label class="form-label">YPID编码</label>
                                <input type="text" class="form-input" placeholder="请输入或搜索YPID编码">
                                <button class="btn btn-warning" style="margin-top: 8px; padding: 6px 12px;">搜索匹配</button>
                            </div>
                            <div class="form-group">
                                <label class="form-label">标准药品名称</label>
                                <input type="text" class="form-input" value="阿司匹林肠溶片" readonly>
                            </div>
                            <div class="form-group">
                                <label class="form-label">匹配说明</label>
                                <textarea class="form-input" rows="3" placeholder="请说明匹配依据和原因">拜阿司匹林为阿司匹林肠溶片的商品名，成分和规格完全一致</textarea>
                            </div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="btn btn-success">确认匹配</button>
                        <button class="btn btn-warning" style="margin-left: 10px;">跳过此条</button>
                        <button class="btn btn-danger" style="margin-left: 10px;">申请新增YPID</button>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">候选YPID列表</h3>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>YPID编码</th>
                                <th>标准名称</th>
                                <th>剂型</th>
                                <th>规格</th>
                                <th>生产企业</th>
                                <th>相似度</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>YP0345678901</td>
                                <td>阿司匹林肠溶片</td>
                                <td>片剂</td>
                                <td>100mg</td>
                                <td>拜耳医药保健有限公司</td>
                                <td><span style="color: #52c41a;">98%</span></td>
                                <td>
                                    <button class="btn btn-success" style="padding: 4px 8px; font-size: 12px;">选择此项</button>
                                </td>
                            </tr>
                            <tr>
                                <td>YP0345678902</td>
                                <td>阿司匹林片</td>
                                <td>片剂</td>
                                <td>100mg</td>
                                <td>石药集团有限公司</td>
                                <td><span style="color: #faad14;">75%</span></td>
                                <td>
                                    <button class="btn btn-warning" style="padding: 4px 8px; font-size: 12px;">查看详情</button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div id="ypid-library-tab" class="tab-content">
                <div class="filter-bar">
                    <div class="filter-item">
                        <label>版本：</label>
                        <select>
                            <option>YPID 5.02版本</option>
                            <option>YPID 5.01版本</option>
                            <option>YPID 5.00版本</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label>分类：</label>
                        <select>
                            <option>全部分类</option>
                            <option>化学药品</option>
                            <option>中成药</option>
                            <option>生物制品</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label>关键词：</label>
                        <input type="text" placeholder="请输入搜索关键词">
                    </div>
                    <button class="btn btn-primary">搜索</button>
                    <button class="btn btn-success">同步最新版本</button>
                </div>

                <div class="alert alert-info">
                    <strong>标准库状态：</strong> 当前使用YPID 5.02版本，包含药品编码 158,432 条，最后更新时间：2024-05-20 10:30
                </div>

                <table class="table">
                    <thead>
                        <tr>
                            <th>YPID编码</th>
                            <th>药品通用名</th>
                            <th>产品名称</th>
                            <th>剂型</th>
                            <th>规格</th>
                            <th>生产企业</th>
                            <th>药品分类</th>
                            <th>更新时间</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>YP0123456789</td>
                            <td>阿莫西林</td>
                            <td>阿莫西林胶囊</td>
                            <td>胶囊剂</td>
                            <td>0.25g</td>
                            <td>华北制药股份有限公司</td>
                            <td>化学药品</td>
                            <td>2024-05-20</td>
                        </tr>
                        <tr>
                            <td>YP0234567890</td>
                            <td>头孢氨苄</td>
                            <td>头孢氨苄片</td>
                            <td>片剂</td>
                            <td>0.25g</td>
                            <td>石药集团有限公司</td>
                            <td>化学药品</td>
                            <td>2024-05-20</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- 6. 报告中心界面 -->
        <div id="reports" class="page">
            <div class="page-header">
                <h1 class="page-title">报告中心</h1>
                <p class="page-description">
                    <strong>界面目的：</strong> 提供质控报告生成、查看和管理功能，支持多种格式的报告导出和分发。<br>
                    <strong>主要功能：</strong> 质控报告生成、报告模板管理、报告历史查询、统计分析展示、报告导出下载和报告分享功能。
                </p>
            </div>

            <div class="tabs">
                <div class="tab-item active" onclick="switchTab('report-generate-tab', this)">生成报告</div>
                <div class="tab-item" onclick="switchTab('report-templates-tab', this)">报告模板</div>
                <div class="tab-item" onclick="switchTab('report-history-tab', this)">报告历史</div>
                <div class="tab-item" onclick="switchTab('statistics-tab', this)">统计分析</div>
            </div>

            <div id="report-generate-tab" class="tab-content active">
                <div class="grid">
                    <div class="card">
                        <h3 class="card-title">快速生成报告</h3>
                        <div class="form-group">
                            <label class="form-label">报告类型</label>
                            <select class="form-input">
                                <option>质控综合报告</option>
                                <option>数据导入报告</option>
                                <option>异常数据报告</option>
                                <option>YPID匹配报告</option>
                                <option>机构数据质量报告</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">报告范围</label>
                            <select class="form-input">
                                <option>全部数据</option>
                                <option>指定时间范围</option>
                                <option>指定医疗机构</option>
                                <option>指定导入任务</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">输出格式</label>
                            <div style="margin-top: 10px;">
                                <label style="margin-right: 20px;">
                                    <input type="checkbox" checked> PDF
                                </label>
                                <label style="margin-right: 20px;">
                                    <input type="checkbox"> Excel
                                </label>
                                <label style="margin-right: 20px;">
                                    <input type="checkbox"> Word
                                </label>
                            </div>
                        </div>
                        <button class="btn btn-primary" style="width: 100%;">生成报告</button>
                    </div>

                    <div class="card">
                        <h3 class="card-title">报告生成进度</h3>
                        <div style="margin: 20px 0;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>数据统计</span>
                                <span>100%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 100%;"></div>
                            </div>
                        </div>
                        <div style="margin: 20px 0;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span>报告生成</span>
                                <span>65%</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: 65%;"></div>
                            </div>
                        </div>
                        <p style="color: #666; margin-top: 15px;">
                            正在生成：质控规则执行情况统计
                        </p>
                        <div style="margin-top: 20px; text-align: center;">
                            <button class="btn btn-warning">取消生成</button>
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">报告预览</h3>
                    <div style="border: 1px solid #d9d9d9; border-radius: 6px; padding: 20px; background: #fafafa; min-height: 300px;">
                        <h4 style="text-align: center; margin-bottom: 20px;">药品使用监测质量控制报告</h4>
                        <div style="margin-bottom: 15px;">
                            <strong>报告概要：</strong>
                            <ul style="margin: 10px 0 0 20px;">
                                <li>数据导入任务：156个，成功率 94.5%</li>
                                <li>质控规则执行：前置22项全部正常，后置7项中6项正常</li>
                                <li>异常数据处理：发现524条异常，已修复420条</li>
                                <li>YPID匹配情况：总体匹配率87.2%，提升3.5%</li>
                            </ul>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <strong>质控建议：</strong>
                            <p style="margin: 10px 0;">1. 建议加强对基层医疗机构的数据填报培训，降低基础字段空值率...</p>
                        </div>
                        <div style="text-align: center; margin-top: 30px;">
                            <button class="btn btn-primary">下载PDF</button>
                            <button class="btn btn-success" style="margin-left: 10px;">下载Excel</button>
                            <button class="btn btn-warning" style="margin-left: 10px;">发送邮件</button>
                        </div>
                    </div>
                </div>
            </div>

            <div id="report-templates-tab" class="tab-content">
                <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 20px;">
                    <h3>报告模板管理</h3>
                    <button class="btn btn-primary">新建模板</button>
                </div>

                <table class="table">
                    <thead>
                        <tr>
                            <th>模板名称</th>
                            <th>模板类型</th>
                            <th>适用范围</th>
                            <th>创建时间</th>
                            <th>使用次数</th>
                            <th>状态</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>标准质控综合报告模板</td>
                            <td>质控报告</td>
                            <td>全部机构</td>
                            <td>2024-01-15</td>
                            <td>87</td>
                            <td><span class="status-badge status-success">启用</span></td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">编辑</button>
                                <button class="btn btn-warning" style="padding: 4px 8px; font-size: 12px;">复制</button>
                                <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;">删除</button>
                            </td>
                        </tr>
                        <tr>
                            <td>三级医院专用报告模板</td>
                            <td>机构报告</td>
                            <td>三级医院</td>
                            <td>2024-02-20</td>
                            <td>34</td>
                            <td><span class="status-badge status-success">启用</span></td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">编辑</button>
                                <button class="btn btn-warning" style="padding: 4px 8px; font-size: 12px;">复制</button>
                                <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;">删除</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="report-history-tab" class="tab-content">
                <div class="filter-bar">
                    <div class="filter-item">
                        <label>报告类型：</label>
                        <select>
                            <option>全部类型</option>
                            <option>质控综合报告</option>
                            <option>数据导入报告</option>
                            <option>异常数据报告</option>
                        </select>
                    </div>
                    <div class="filter-item">
                        <label>生成时间：</label>
                        <input type="date" value="2024-05-01">
                        <span>至</span>
                        <input type="date" value="2024-05-29">
                    </div>
                    <button class="btn btn-primary">查询</button>
                </div>

                <table class="table">
                    <thead>
                        <tr>
                            <th>报告名称</th>
                            <th>报告类型</th>
                            <th>数据范围</th>
                            <th>生成时间</th>
                            <th>文件大小</th>
                            <th>下载次数</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2024年5月质控综合报告</td>
                            <td>质控综合报告</td>
                            <td>全部机构</td>
                            <td>2024-05-29 10:30</td>
                            <td>2.3MB</td>
                            <td>15</td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">下载</button>
                                <button class="btn btn-success" style="padding: 4px 8px; font-size: 12px;">分享</button>
                                <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;">删除</button>
                            </td>
                        </tr>
                        <tr>
                            <td>北京协和医院数据质量报告</td>
                            <td>机构报告</td>
                            <td>北京协和医院</td>
                            <td>2024-05-28 16:45</td>
                            <td>1.8MB</td>
                            <td>8</td>
                            <td>
                                <button class="btn btn-primary" style="padding: 4px 8px; font-size: 12px;">下载</button>
                                <button class="btn btn-success" style="padding: 4px 8px; font-size: 12px;">分享</button>
                                <button class="btn btn-danger" style="padding: 4px 8px; font-size: 12px;">删除</button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div id="statistics-tab" class="tab-content">
                <div class="grid">
                    <div class="card">
                        <h3 class="card-title">月度趋势统计</h3>
                        <div style="height: 200px; background: #f5f5f5; border-radius: 6px; display: flex; align-items: center; justify-content: center; color: #666;">
                            [数据导入量/质控通过率趋势图]
                        </div>
                    </div>
                    <div class="card">
                        <h3 class="card-title">异常类型分布</h3>
                        <div style="height: 200px; background: #f5f5f5; border-radius: 6px; display: flex; align-items: center; justify-content: center; color: #666;">
                            [异常类型饼图]
                        </div>
                    </div>
                </div>

                <div class="card">
                    <h3 class="card-title">机构数据质量排名</h3>
                    <table class="table">
                        <thead>
                            <tr>
                                <th>排名</th>
                                <th>医疗机构</th>
                                <th>数据完整性</th>
                                <th>质控通过率</th>
                                <th>YPID匹配率</th>
                                <th>综合评分</th>
                                <th>等级</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1</td>
                                <td>北京协和医院</td>
                                <td>98.5%</td>
                                <td>96.8%</td>
                                <td>94.2%</td>
                                <td>96.5</td>
                                <td><span class="status-badge status-success">优秀</span></td>
                            </tr>
                            <tr>
                                <td>2</td>
                                <td>上海瑞金医院</td>
                                <td>97.2%</td>
                                <td>95.1%</td>
                                <td>92.8%</td>
                                <td>95.0</td>
                                <td><span class="status-badge status-success">优秀</span></td>
                            </tr>
                            <tr>
                                <td>3</td>
                                <td>广州中山医院</td>
                                <td>89.6%</td>
                                <td>88.3%</td>
                                <td>85.7%</td>
                                <td>87.9</td>
                                <td><span class="status-badge status-success">良好</span></td>
                            </tr>
                            <tr>
                                <td>4</td>
                                <td>四川华西医院</td>
                                <td>91.8%</td>
                                <td>89.7%</td>
                                <td>88.3%</td>
                                <td>89.9</td>
                                <td><span class="status-badge status-success">良好</span></td>
                            </tr>
                            <tr>
                                <td>5</td>
                                <td>西安交大一附院</td>
                                <td>85.2%</td>
                                <td>82.4%</td>
                                <td>79.6%</td>
                                <td>82.4</td>
                                <td><span class="status-badge status-warning">合格</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="card">
                    <h3 class="card-title">质控规则执行效果分析</h3>
                    <div style="margin: 20px 0;">
                        <h4 style="margin-bottom: 15px;">前置质控规则TOP5（按发现异常数量排序）</h4>
                        <table class="table">
                            <thead>
                            <tr>
                                <th>规则名称</th>
                                <th>触发次数</th>
                                <th>发现异常</th>
                                <th>修复成功</th>
                                <th>修复率</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr>
                                <td>YPID编码空值检查</td>
                                <td>1,258</td>
                                <td>892</td>
                                <td>756</td>
                                <td>84.7%</td>
                            </tr>
                            <tr>
                                <td>必填项未按要求填报</td>
                                <td>2,156</td>
                                <td>634</td>
                                <td>598</td>
                                <td>94.3%</td>
                            </tr>
                            <tr>
                                <td>数据格式错误</td>
                                <td>987</td>
                                <td>445</td>
                                <td>423</td>
                                <td>95.1%</td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // 页面切换功能
        function showPage(pageId) {
            // 隐藏所有页面
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.classList.remove('active'));

            // 显示指定页面
            document.getElementById(pageId).classList.add('active');

            // 更新导航状态
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => item.classList.remove('active'));
            event.target.classList.add('active');
        }

        // 标签页切换功能
        function switchTab(tabId, element) {
            // 获取父级标签容器
            const tabContainer = element.closest('.page');

            // 隐藏所有标签内容
            const tabContents = tabContainer.querySelectorAll('.tab-content');
            tabContents.forEach(content => content.classList.remove('active'));

            // 显示指定标签内容
            document.getElementById(tabId).classList.add('active');

            // 更新标签状态
            const tabItems = tabContainer.querySelectorAll('.tab-item');
            tabItems.forEach(item => item.classList.remove('active'));
            element.classList.add('active');
        }

        // 全选功能
        function toggleAll(checkbox) {
            const checkboxes = document.querySelectorAll('tbody input[type="checkbox"]');
            checkboxes.forEach(cb => cb.checked = checkbox.checked);
        }

        // 文件上传处理
        document.getElementById('fileInput').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const uploadArea = document.querySelector('.upload-area');
                uploadArea.innerHTML = `
                    <div class="upload-icon">📄</div>
                    <h3>已选择文件：${file.name}</h3>
                    <p>文件大小：${(file.size / 1024 / 1024).toFixed(2)} MB</p>
                    <div style="margin-top: 15px;">
                        <button class="btn btn-success">确认上传</button>
                        <button class="btn btn-warning" style="margin-left: 10px;" onclick="resetUpload()">重新选择</button>
                    </div>
                `;
            }
        });

        // 重置上传区域
        function resetUpload() {
            const uploadArea = document.querySelector('.upload-area');
            uploadArea.innerHTML = `
                <div class="upload-icon">📁</div>
                <h3>点击或拖拽Excel文件到此处</h3>
                <p>支持.xlsx、.xls格式，文件大小不超过100MB</p>
                <input type="file" id="fileInput" style="display: none;" accept=".xlsx,.xls">
            `;

            // 重新绑定事件监听器
            document.getElementById('fileInput').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const uploadArea = document.querySelector('.upload-area');
                    uploadArea.innerHTML = `
                        <div class="upload-icon">📄</div>
                        <h3>已选择文件：${file.name}</h3>
                        <p>文件大小：${(file.size / 1024 / 1024).toFixed(2)} MB</p>
                        <div style="margin-top: 15px;">
                            <button class="btn btn-success">确认上传</button>
                            <button class="btn btn-warning" style="margin-left: 10px;" onclick="resetUpload()">重新选择</button>
                        </div>
                    `;
                }
            });
        }

        // 模拟进度条更新
        function updateProgress() {
            const progressBars = document.querySelectorAll('.progress-fill');
            progressBars.forEach(bar => {
                const currentWidth = parseInt(bar.style.width) || 0;
                if (currentWidth < 100) {
                    bar.style.width = Math.min(currentWidth + Math.random() * 10, 100) + '%';
                }
            });
        }

        // 模拟数据刷新
        function refreshData() {
            // 更新统计数字
            const statNumbers = document.querySelectorAll('.stat-number');
            statNumbers.forEach(stat => {
                const currentValue = parseInt(stat.textContent) || 0;
                const change = Math.floor(Math.random() * 10) - 5;
                stat.textContent = Math.max(0, currentValue + change);
            });
        }

        // 表格排序功能
        function sortTable(table, column, type = 'string') {
            const rows = Array.from(table.querySelector('tbody').rows);
            const sortedRows = rows.sort((a, b) => {
                const aVal = a.cells[column].textContent.trim();
                const bVal = b.cells[column].textContent.trim();

                if (type === 'number') {
                    return parseFloat(aVal) - parseFloat(bVal);
                } else {
                    return aVal.localeCompare(bVal);
                }
            });

            const tbody = table.querySelector('tbody');
            tbody.innerHTML = '';
            sortedRows.forEach(row => tbody.appendChild(row));
        }

        // 搜索过滤功能
        function filterTable(input, tableId) {
            const filter = input.value.toLowerCase();
            const table = document.getElementById(tableId);
            const rows = table.getElementsByTagName('tr');

            for (let i = 1; i < rows.length; i++) {
                const cells = rows[i].getElementsByTagName('td');
                let found = false;

                for (let j = 0; j < cells.length; j++) {
                    if (cells[j].textContent.toLowerCase().includes(filter)) {
                        found = true;
                        break;
                    }
                }

                rows[i].style.display = found ? '' : 'none';
            }
        }

        // 导出功能
        function exportData(format, data) {
            switch(format) {
                case 'excel':
                    // 模拟Excel导出
                    alert('正在生成Excel文件...');
                    setTimeout(() => {
                        alert('Excel文件已生成，开始下载');
                    }, 2000);
                    break;
                case 'pdf':
                    // 模拟PDF导出
                    alert('正在生成PDF文件...');
                    setTimeout(() => {
                        alert('PDF文件已生成，开始下载');
                    }, 2000);
                    break;
                case 'csv':
                    // 模拟CSV导出
                    alert('正在生成CSV文件...');
                    setTimeout(() => {
                        alert('CSV文件已生成，开始下载');
                    }, 1000);
                    break;
            }
        }

        // 页面加载完成后的初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 定时更新进度条
            setInterval(updateProgress, 3000);

            // 定时刷新数据
            setInterval(refreshData, 30000);

            // 添加表格行点击事件
            document.querySelectorAll('.table tbody tr').forEach(row => {
                row.addEventListener('click', function() {
                    this.style.backgroundColor = this.style.backgroundColor ? '' : '#e6f7ff';
                });
            });

            // 添加悬停效果
            document.querySelectorAll('.card').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-2px)';
                    this.style.boxShadow = '0 4px 12px rgba(0,0,0,0.15)';
                });

                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0)';
                    this.style.boxShadow = '0 2px 8px rgba(0,0,0,0.1)';
                });
            });

            // 添加按钮点击反馈
            document.querySelectorAll('.btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    if (!this.disabled) {
                        this.style.transform = 'scale(0.98)';
                        setTimeout(() => {
                            this.style.transform = 'scale(1)';
                        }, 100);
                    }
                });
            });

            // 表单验证
            document.querySelectorAll('form').forEach(form => {
                form.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const inputs = this.querySelectorAll('input[required], select[required], textarea[required]');
                    let isValid = true;

                    inputs.forEach(input => {
                        if (!input.value.trim()) {
                            input.style.borderColor = '#ff4d4f';
                            isValid = false;
                        } else {
                            input.style.borderColor = '#d9d9d9';
                        }
                    });

                    if (isValid) {
                        alert('表单提交成功！');
                    } else {
                        alert('请填写所有必需字段');
                    }
                });
            });

            // 键盘快捷键支持
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey) {
                    switch(e.key) {
                        case '1':
                            e.preventDefault();
                            showPage('dashboard');
                            break;
                        case '2':
                            e.preventDefault();
                            showPage('upload');
                            break;
                        case '3':
                            e.preventDefault();
                            showPage('qc-rules');
                            break;
                        case '4':
                            e.preventDefault();
                            showPage('data-governance');
                            break;
                        case '5':
                            e.preventDefault();
                            showPage('ypid-management');
                            break;
                        case '6':
                            e.preventDefault();
                            showPage('reports');
                            break;
                    }
                }
            });

            console.log('药品使用监测质量控制平台界面已加载完成');
            console.log('支持的快捷键：Ctrl+1-6 切换不同页面');
        });

        // 通知系统
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `alert alert-${type}`;
            notification.style.position = 'fixed';
            notification.style.top = '20px';
            notification.style.right = '20px';
            notification.style.zIndex = '9999';
            notification.style.minWidth = '300px';
            notification.innerHTML = message;

            document.body.appendChild(notification);

            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // 权限检查模拟
        function checkPermission(action) {
            const userRole = '数据管理员'; // 模拟当前用户角色
            const permissions = {
                '系统管理员': ['upload', 'qc-config', 'data-repair', 'ypid-manage', 'report-generate', 'user-manage'],
                '数据管理员': ['upload', 'data-repair', 'ypid-manage', 'report-generate'],
                '数据查看员': ['report-view'],
                '医疗机构用户': ['upload-own', 'report-view-own']
            };

            return permissions[userRole]?.includes(action) || false;
        }

        // 数据同步状态检查
        function checkSyncStatus() {
            // 模拟数据同步状态检查
            const lastSync = new Date(Date.now() - Math.random() * 3600000); // 随机过去1小时内
            const syncStatus = document.createElement('div');
            syncStatus.innerHTML = `
                <small style="color: #666;">
                    最后同步时间: ${lastSync.toLocaleString()}
                    <span style="color: #52c41a;">●</span> 同步正常
                </small>
            `;

            return syncStatus.innerHTML;
        }

        // 错误处理
        window.addEventListener('error', function(e) {
            console.error('页面错误:', e.error);
            showNotification('系统出现错误，请刷新页面重试', 'error');
        });

        // 性能监控
        window.addEventListener('load', function() {
            const loadTime = window.performance.timing.loadEventEnd - window.performance.timing.navigationStart;
            console.log(`页面加载时间: ${loadTime}ms`);

            if (loadTime > 3000) {
                showNotification('页面加载较慢，建议检查网络连接', 'warning');
            }
        });
    </script>

    <!-- 页面底部信息 -->
    <footer style="background: #f5f7fa; padding: 20px 0; margin-top: 40px; text-align: center; color: #666; font-size: 14px;">
        <div class="container">
            <p>药品使用监测质量控制平台 v1.0 | 基于芋道框架开发</p>
            <p>技术支持: Spring Boot 3.2 + Vue 3 + Element Plus |
                <span id="sync-status"></span>
            </p>
        </div>
    </footer>

    <script>
        // 更新同步状态显示
        document.getElementById('sync-status').innerHTML = checkSyncStatus();

        // 定时更新同步状态
        setInterval(() => {
            document.getElementById('sync-status').innerHTML = checkSyncStatus();
        }, 60000); // 每分钟更新一次
    </script>
</body>
</html>
